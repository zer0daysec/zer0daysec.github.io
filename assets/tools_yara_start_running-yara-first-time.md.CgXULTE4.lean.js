import{_ as a,c as i,a3 as e,o as t}from"./chunks/framework.DtMx7FFi.js";const k=JSON.parse('{"title":"首次运行 yara","description":"","frontmatter":{"layout":"doc","title":"首次运行 yara"},"headers":[],"relativePath":"tools/yara/start/running-yara-first-time.md","filePath":"tools/yara/start/running-yara-first-time.md"}'),l={name:"tools/yara/start/running-yara-first-time.md"};function n(p,s,d,h,o,r){return t(),i("div",null,s[0]||(s[0]=[e(`<div class="title-wrapper"><div class="page-title">首次运行</div><div class="post-title">—— yara 使用手册 · 开始 <span class="lastModifyTime"><i class="fa-regular fa-clock"></i> 最后更新： 2023-03-08 22:27:53 </span></div></div><p>现在你已经安装了 Yara，可以编写一个非常简单的规则并使用命令行工具扫描某些文件：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;rule dummy { condition: true }&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my_first_rule</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yara</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my_first_rule</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my_first_rule</span></span></code></pre></div><p>不要对 yara 参数中出现两个 <code>my_first_rule</code> 感到困惑，这只是传递相同的文件作为规则和要扫描的文件。你可以传递任何要扫描的文件 (第二个参数)。</p><p>如果一切顺利，应该得到以下输出：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>dummy my_first_rule</span></span></code></pre></div><p>这意味着文件 <code>my_first_rule</code> 与名为 <code>dummy</code> 的规则匹配，如果遇到这样的错误：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>yara: error while loading shared libraries: libyara.so.2: cannot open shared</span></span>
<span class="line"><span>object file: No such file or directory</span></span></code></pre></div><p>这意味着加载程序找不到位于 <code>/usr/local/lib</code> 中的 <code>libyara</code> 库。在某些 Linux 版本中，加载程序默认不会在此路径中查找库，我们必须通过将 <code>/usr/local/lib</code> 添加到加载程序 <code>/etc/ld.so.conf</code> 配置文件来指示它这样做：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;echo &quot;/usr/local/lib&quot; &gt;&gt; /etc/ld.so.conf&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ldconfig</span></span></code></pre></div><p>在较新的 Ubuntu 版本 (例如 22.04 LTS) 上，正确的加载器配置是通过 <code>/etc/ld.so.conf.d/libc.conf</code> 的依赖项安装的。在这种情况下，仅使用以下命令就足以配置动态链接器运行时绑定。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ldconfig</span></span></code></pre></div><p>如果使用 Windows PowerShell 作为命令 shell，<code>yara my_first_rule my_first_rule</code> 可能会返回以下错误：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">my_first_rule(1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): error: non-ascii character</span></span></code></pre></div><p>可以通过在创建规则文件时使用 <code>Set-Content</code> cmdlet 指定 ascii 输出来避免这种情况：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Set-Content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path .\\my_first_rule </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Value </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rule dummy { condition: true }&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Encoding Ascii</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.\\yara my_first_rule my_first_rule</span></span></code></pre></div>`,16)]))}const u=a(l,[["render",n]]);export{k as __pageData,u as default};
